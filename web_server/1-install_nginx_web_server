#!/usr/bin/env bash

# This script installs and configures Nginx to listen on port 80 and serve a page containing "Holberton School".

# Update the package list
apt update

# Install Nginx
apt install -y nginx

# Configure Nginx to listen on port 80
cat <<EOF > /etc/nginx/sites-available/default
server {
    listen 80;
    root /var/www/html;
    index index.html;
    server_name _;

    location / {
        try_files \$uri \$uri/ =404;
    }
}
EOF

# Create a simple HTML page
echo "Holberton School" > /var/www/html/index.html

# Ensure correct permissions
chown -R www-data:www-data /var/www/html
chmod -R 755 /var/www/html

# Remove any existing Nginx PID files to avoid issues
rm -f /run/nginx/nginx.pid

# Restart Nginx (without using systemctl)
nginx -s reload

# Verify Nginx is running and listening on port 80
netstat -tuln | grep ':80' || ss -tuln | grep ':80'

# Verify the page content
curl -I http://localhost
curl http://localhost

